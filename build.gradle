buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'se.transmode.gradle:gradle-docker:1.2'
    }
}

plugins {
    id 'java'
    id 'org.springframework.boot' version '1.5.4.RELEASE'
    id 'io.franzbecker.gradle-lombok' version '1.8'
}

apply plugin: 'docker'

ext {
    springBootVersion = '1.5.4.RELEASE'
    springFoxVersion = '2.4.0'
}

repositories {
    jcenter()
    // TODO[r0i001q]: Apontar para repositorio walmart

}

docker {
    maintainer = "Feeds - Walmart"
    // TODO[r0i001q]: Configurar push para registry do walmart
//    registry = "docker-registry.qa.vmcommerce.intra"
}

task buildDocker(type: Docker) {

    push = false
    dockerfile = file('docker/Dockerfile')
    applicationName = project.name

    doFirst {
        copy {
            from jar
            into stageDir
        }
    }
}

dependencies {

    compile "org.springframework.boot:spring-boot-starter-web:${springBootVersion}"
    compile "org.springframework.boot:spring-boot-starter-data-jpa:${springBootVersion}"
    compile "org.springframework.boot:spring-boot-starter-test:${springBootVersion}"
    compile "org.modelmapper:modelmapper:1.1.0"
    compile "com.h2database:h2"
    
    compile "io.springfox:springfox-swagger2:${springFoxVersion}"
    compile "io.springfox:springfox-swagger-ui:${springFoxVersion}"

}

